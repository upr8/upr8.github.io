@import 'tailwindcss';

/* Specify content sources for Tailwind to scan */
@source "../../data/**/*.mdx";
@source "../{components,templates,pages}/**/*.{ts,tsx}";

@theme {
  /* Font family */
  --font-family-body:
    "IBM Plex Sans Variable",
    "IBM Plex Sans",
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";

  /* Light theme colors */
  --color-bg-body-light: #f5f5f5; /* Neutral 100 */
  --color-bg-nav-light: #bfdbfe;  /* blue 200 */
  --color-bg-bq-light: #ccc;
  --color-border-primary-light: #0c4a6e; /* sky 900 */
  --color-border-secondary-light: #bae6fd; /* sky 200 */
  --color-text-primary-light: #262626; /* natural 800 */
  --color-text-secondary-light: #4b5563; /* gray 600 */
  --color-link-primary-light: #075985; /* sky 800 - improved contrast for AAA compliance (7.7:1) */
  --color-link-hover-light: #0c4a6e; /* sky 900 */
  --color-link-active-light: #0c4a6e; /* sky 900 */
  --color-link-visited-light: #5b21b6; /* violet 800 - improved contrast for AA compliance (7.4:1) */
  --color-bg-table-head-light: #cbd5e1; /* slate 300 */
  --color-bg-table-even-light: #f1f5f9; /* slate 100 */
  --color-bg-table-odd-light: #f8fafc; /* slate 50 */
  --color-border-table-light: #334155; /* slate 700 */

  /* Dark theme colors */
  --color-bg-body-dark: #18181b; /* Neutral 900 */
  --color-bg-nav-dark: #083344;  /* Cyan 950 - improved contrast for AA compliance (12.8:1) */
  --color-bg-bq-dark: #222;
  --color-border-primary-dark: #e0f2fe; /* sky 100 */
  --color-border-secondary-dark: #075985; /* sky 800 */
  --color-text-primary-dark: #f5f5f5; /* natural 100 */
  --color-text-secondary-dark: #d1d5db; /* gray 300 */
  --color-link-primary-dark: #38bdf8; /* sky 400 */
  --color-link-hover-dark: #7dd3fc; /* sky 300 */
  --color-link-active-dark: #0ea5e9; /* sky 500 */
  --color-link-visited-dark: #a78bfa; /* violet 400 */
  --color-bg-table-head-dark: #334155; /* slate 700 */
  --color-bg-table-even-dark: #0f172a; /* slate 900 */
  --color-bg-table-odd-dark: #020617; /* slate 950 */
  --color-border-table-dark: #cbd5e1; /* slate 300 */

  /* Typography scale (~1.25 ratio) */
  --font-size-xs: 0.75rem;    /* 12px */
  --font-size-sm: 0.875rem;   /* 14px */
  --font-size-base: 1rem;     /* 16px */
  --font-size-lg: 1.125rem;   /* 18px */
  --font-size-xl: 1.25rem;    /* 20px */
  --font-size-2xl: 1.5rem;    /* 24px */
  --font-size-3xl: 1.875rem;  /* 30px */
  --font-size-4xl: 2.25rem;   /* 36px */
  --font-size-5xl: 3rem;      /* 48px */

  /* Line heights */
  --leading-tight: 1.25;
  --leading-snug: 1.375;
  --leading-normal: 1.5;
  --leading-relaxed: 1.625;
  --leading-loose: 2;

  /* Letter spacing */
  --tracking-tighter: -0.05em;
  --tracking-tight: -0.025em;
  --tracking-normal: 0;
  --tracking-wide: 0.025em;
  --tracking-wider: 0.05em;
}

@custom-variant dark (&:is(.dark *));

/* Set theme-specific CSS variables on the body element */
@layer base {
  .body-theme-light {
    --color-bg-body: var(--color-bg-body-light);
    --color-bg-nav: var(--color-bg-nav-light);
    --color-bg-bq: var(--color-bg-bq-light);
    --color-border-primary: var(--color-border-primary-light);
    --color-border-secondary: var(--color-border-secondary-light);
    --color-text-primary: var(--color-text-primary-light);
    --color-text-secondary: var(--color-text-secondary-light);
    --color-link-primary: var(--color-link-primary-light);
    --color-link-hover: var(--color-link-hover-light);
    --color-link-active: var(--color-link-active-light);
    --color-link-visited: var(--color-link-visited-light);
    --color-bg-table-head: var(--color-bg-table-head-light);
    --color-bg-table-even: var(--color-bg-table-even-light);
    --color-bg-table-odd: var(--color-bg-table-odd-light);
    --color-border-table: var(--color-border-table-light);
  }

  .body-theme-dark {
    --color-bg-body: var(--color-bg-body-dark);
    --color-bg-nav: var(--color-bg-nav-dark);
    --color-bg-bq: var(--color-bg-bq-dark);
    --color-border-primary: var(--color-border-primary-dark);
    --color-border-secondary: var(--color-border-secondary-dark);
    --color-text-primary: var(--color-text-primary-dark);
    --color-text-secondary: var(--color-text-secondary-dark);
    --color-link-primary: var(--color-link-primary-dark);
    --color-link-hover: var(--color-link-hover-dark);
    --color-link-active: var(--color-link-active-dark);
    --color-link-visited: var(--color-link-visited-dark);
    --color-bg-table-head: var(--color-bg-table-head-dark);
    --color-bg-table-even: var(--color-bg-table-even-dark);
    --color-bg-table-odd: var(--color-bg-table-odd-dark);
    --color-border-table: var(--color-border-table-dark);
  }
}

/* Theme-aware utilities using the mapped CSS variables */
@utility font-body {
  font-family: var(--font-family-body);
}

@utility bg-body {
  background-color: var(--color-bg-body);
}

@utility bg-nav {
  background-color: var(--color-bg-nav);
}

@utility bg-bq {
  background-color: var(--color-bg-bq);
}

@utility bg-table-head {
  background-color: var(--color-bg-table-head);
}

@utility bg-table-even {
  background-color: var(--color-bg-table-even);
}

@utility bg-table-odd {
  background-color: var(--color-bg-table-odd);
}

@utility border-primary {
  border-color: var(--color-border-primary);
}

@utility border-secondary {
  border-color: var(--color-border-secondary);
}

@utility border-table {
  border-color: var(--color-border-table);
}

@utility text-primary {
  color: var(--color-text-primary);
}

@utility text-secondary {
  color: var(--color-text-secondary);
}

@utility text-accent-primary {
  color: var(--color-link-primary);
}

@utility text-accent-hover {
  color: var(--color-link-hover);
}

@utility text-accent-active {
  color: var(--color-link-active);
}

@utility text-accent-visited {
  color: var(--color-link-visited);
}

@utility decoration-accent-primary {
  text-decoration-color: var(--color-link-primary);
}

@utility decoration-accent-hover {
  text-decoration-color: var(--color-link-hover);
}

@utility ring-accent-primary {
  --tw-ring-color: var(--color-link-primary);
}

@utility ring-offset-body {
  --tw-ring-offset-color: var(--color-bg-body);
}

/* Typography utilities */
@utility heading-1 {
  font-size: var(--font-size-4xl);
  font-weight: 800;
  line-height: var(--leading-tight);
  letter-spacing: var(--tracking-tight);
}

@utility heading-2 {
  font-size: var(--font-size-2xl);
  font-weight: 600;
  line-height: var(--leading-snug);
}

@utility heading-3 {
  font-size: var(--font-size-xl);
  font-weight: 600;
  line-height: var(--leading-snug);
}

@utility heading-4 {
  font-size: var(--font-size-lg);
  font-weight: 500;
  line-height: var(--leading-normal);
}

@utility heading-5 {
  font-size: var(--font-size-base);
  font-weight: 500;
  line-height: var(--leading-normal);
}

@utility heading-6 {
  font-size: var(--font-size-sm);
  font-weight: 500;
  line-height: var(--leading-normal);
  text-transform: uppercase;
  letter-spacing: var(--tracking-wide);
}

@utility body-text {
  font-size: var(--font-size-base);
  line-height: var(--leading-relaxed);
}

/* Prevent layout shift when scrollbar appears */
html {
    scrollbar-gutter: stable;
}

.bidi-en {
    unicode-bidi: bidi-override;
    direction: ltr;
    text-align: left;
}

/* Base link styles */
a {
    @apply text-accent-primary;
    @apply transition-colors duration-150;
    @apply underline underline-offset-2;
    text-decoration-color: color-mix(in srgb, var(--color-link-primary) 30%, transparent);

    &:hover {
        @apply text-accent-hover decoration-accent-hover;
    }

    &:active {
        @apply text-accent-active;
    }

    &:focus-visible {
        @apply outline-hidden ring-2 ring-accent-primary ring-offset-2 ring-offset-body;
    }

    /* Visited links */
    &:visited {
        @apply text-accent-visited;
    }
}

/* Links within body text should have visible underline */
.prose a,
.postBody a {
    @apply underline underline-offset-4;
    text-decoration-color: color-mix(in srgb, var(--color-link-primary) 50%, transparent);

    &:hover {
        @apply decoration-accent-hover;
    }
}
