<!DOCTYPE html><html lang="en" dir="ltr"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="generator" content="Astro v5.16.8"><title>SQL: SELECT | Saeed Asaiyan</title><meta name="description" content="Or maybe a cheatsheet for SELECT command"><link rel="canonical" href="https://www.asaiyan.com/en/sql-select/"><!-- Favicon --><link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.svg"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://www.asaiyan.com/en/sql-select/"><meta property="og:title" content="SQL: SELECT"><meta property="og:description" content="Or maybe a cheatsheet for SELECT command"><meta property="og:locale" content="en_US"><!-- Twitter --><meta name="twitter:card" content="summary"><meta name="twitter:title" content="SQL: SELECT"><meta name="twitter:description" content="Or maybe a cheatsheet for SELECT command"><meta name="twitter:site" content="https://www.asaiyan.com/en/sql-select/"><!-- Prevent FLoC tracking --><meta http-equiv="Permissions-Policy" content="interest-cohort=()"><!-- RSS Feed --><link rel="alternate" type="application/rss+xml" title="Saeed Asaiyan" href="/en/rss.xml"><!-- Sitemap --><link rel="sitemap" href="/sitemap-index.xml"><!-- Theme initialization script - runs before page render to prevent flash --><script>
  (function() {
    const stored = localStorage.getItem('theme');
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const theme = stored || (prefersDark ? 'dark' : 'light');

    // Set dark class on html element (body doesn't exist yet)
    document.documentElement.classList.toggle('dark', theme === 'dark');
    // Store theme for body script to use
    document.documentElement.dataset.theme = theme;
  })();
</script><link rel="stylesheet" href="/_astro/_slug_.DxWS4iZI.css"><script type="module" src="/_astro/page.sJrt8mpm.js"></script></head> <body class="bg-body font-sans body-lang-english"> <script>
      // Set body theme class (html element already has dark class from head script)
      (function() {
        const theme = document.documentElement.dataset.theme || 'light';
        document.body.classList.add(`body-theme-${theme}`);
      })();
    </script> <a href="#main-content" class="sr-only focus:not-sr-only focus:absolute focus:top-2 focus:left-2 focus:z-50 focus:px-4 focus:py-2 focus:bg-nav focus:text-primary focus:rounded focus:outline-2 focus:outline-offset-2 focus:outline-accent-primary">
Skip to main content
</a> <div class="antialiased pt-10"> <div class="box-border max-w-full px-4 sm:mx-4 lg:max-w-4xl lg:mx-auto"> <header class="border-b-2 border-primary"> <div class="fixed top-0 left-0 right-0 z-40 px-4 sm:px-0"> <nav id="main-nav" class="transition-[background] duration-150 max-w-full sm:mx-4 lg:max-w-4xl lg:mx-auto bg-nav" role="navigation" aria-label="Main navigation and reading progress"> <div class="flex items-center justify-between px-4 py-1"> <!-- Mobile menu button --> <button type="button" id="mobile-menu-button" class="sm:hidden p-1 -ml-1 text-primary hover:text-accent-primary transition-colors" aria-expanded="false" aria-controls="mobile-menu" aria-label="Open menu"> <span id="menu-icon"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" aria-hidden="true"> <title>Menu</title> <path stroke-linecap="round" stroke-linejoin="round" d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path> </svg></span> <span id="close-icon" class="hidden"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6" aria-hidden="true"> <title>Close</title> <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12"></path> </svg></span> </button> <!-- Desktop navigation --> <ul class="hidden sm:flex sm:items-center sm:gap-6 text-primary"> <li> <a href="/" class="no-underline hover:text-accent-primary transition-colors" aria-label="Navigate to home page"> Home </a> </li><li> <a href="/en/blog" class="no-underline hover:text-accent-primary transition-colors" aria-label="Navigate to blog posts"> Blog </a> </li><li> <a href="/en/library" class="no-underline hover:text-accent-primary transition-colors" aria-label="Navigate to library and book reviews"> Library </a> </li><li> <a href="/en/archive" class="no-underline hover:text-accent-primary transition-colors" aria-label="Navigate to curated archives"> Archive </a> </li><li> <a href="/en/about" class="no-underline hover:text-accent-primary transition-colors" aria-label="Navigate to about page"> About </a> </li> </ul> <!-- Theme switcher - always visible --> <div class="flex items-center"> <label for="toggleTheme" class="relative flex items-center justify-center pt-1 cursor-pointer" id="theme-switcher-label"> <input id="toggleTheme" type="checkbox" class="hidden peer" aria-label="Toggle theme"> <div class="w-10 h-4 rounded-full shadow-inner bg-body" aria-hidden="true"></div> <div id="theme-indicator" class="absolute w-5 h-5 rounded-full shadow-sm inset-y-0 left-0 top-[0.1rem] flex items-center justify-center bg-yellow-200 peer-checked:bg-gray-200 peer-checked:translate-x-full transition-all duration-300 ease-in-out" aria-hidden="true"> <!-- Sun icon --> <span id="sun-icon"> <svg class="w-3 h-3 text-yellow-800 fill-current" viewBox="0 0 2267 2267" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"> <title>Sun icon for light theme</title> <path d="M0 1133q0-39 27-66 28-26 64-26h218q37 0 61.5 27t24.5 65-24.5 64.5T309 1224H91q-37 0-64-27t-27-64zm305 739q0-37 25-65l157-152q24-25 63-25 38 0 63.5 24t25.5 61q0 39-26 68l-152 152q-65 51-131 0-25-27-25-63zm0-1477q0-37 25-65 31-26 68-26 35 0 63 26l152 157q26 24 26 63 0 38-25.5 63.5T550 639q-39 0-63-26L330 461q-25-27-25-66zm272 738q0-149 75-277.5T855.5 652t277.5-75q112 0 215 44.5t177.5 119T1644 918t44 215q0 150-74.5 278T1411 1613.5t-278 74.5-278-74.5T652 1411t-75-278zm181 0q0 156 109.5 266.5T1133 1510t266.5-110.5T1510 1133q0-154-110.5-263T1133 761q-155 0-265 109t-110 263zm284 829q0-38 26.5-64t64.5-26q39 0 65 26t26 64v212q0 39-26.5 66t-64.5 27-64.5-27-26.5-66v-212zm0-1653V91q0-37 27-64t64-27 64 27 27 64v218q0 37-26.5 61.5T1133 395t-64.5-24.5T1042 309zm589 1406q0-37 24-60 24-25 60-25 39 0 64 25l156 152q26 28 26 65t-26 63q-64 50-128 0l-152-152q-24-27-24-68zm0-1165q0-40 24-63l152-157q28-26 63-26 38 0 64.5 27t26.5 64q0 40-26 66l-156 152q-29 26-64 26-36 0-60-25.5t-24-63.5zm241 583q0-38 26-66 26-26 61-26h216q37 0 64.5 27.5t27.5 64.5-27.5 64-64.5 27h-216q-37 0-62-26.5t-25-64.5z"></path> </svg> </span> <!-- Moon icon --> <span id="moon-icon" class="hidden"> <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="w-3 h-3 text-gray-700 fill-current" aria-hidden="true" focusable="false"> <title>Moon icon for dark theme</title> <path class="heroicon-ui" d="M9.57 3.38a8 8 0 0 0 10.4 10.4 1 1 0 0 1 1.31 1.3 10 10 0 1 1-13-13 1 1 0 0 1 1.3 1.3zM7.1 5.04A8 8 0 1 0 18.3 16.27 10 10 0 0 1 7.08 5.04z"></path> </svg> </span> </div> </label> <script type="module">function m(){const t=document.getElementById("toggleTheme"),s=document.getElementById("theme-switcher-label"),d=document.getElementById("sun-icon"),o=document.getElementById("moon-icon");if(!t||!s||!d||!o)return;const c=document.documentElement.classList.contains("dark");t.checked=c,a(c),i(c),t.addEventListener("change",()=>{const e=t.checked,n=e?"dark":"light";localStorage.setItem("theme",n),document.documentElement.classList.toggle("dark",e),document.body.classList.remove("body-theme-light","body-theme-dark"),document.body.classList.add(`body-theme-${n}`),a(e),i(e)});function a(e){e?(d.classList.add("hidden"),o.classList.remove("hidden")):(d.classList.remove("hidden"),o.classList.add("hidden"))}function i(e){const n=e?"light":"dark";s?.setAttribute("aria-label",`Switch to ${n} theme`),t.setAttribute("aria-label",`Theme switcher, currently ${e?"dark":"light"} mode`)}}m();document.addEventListener("astro:after-swap",m);</script> </div> </div> <!-- Mobile navigation menu --> <div id="mobile-menu" class="sm:hidden overflow-hidden transition-all duration-300 ease-in-out bg-nav max-h-0 opacity-0"> <ul class="flex flex-col px-4 pb-4 pt-2 space-y-2 text-primary"> <li> <a href="/" class="block py-2 no-underline hover:text-accent-primary transition-colors mobile-nav-link" aria-label="Navigate to home page"> Home </a> </li><li> <a href="/en/blog" class="block py-2 no-underline hover:text-accent-primary transition-colors mobile-nav-link" aria-label="Navigate to blog posts"> Blog </a> </li><li> <a href="/en/library" class="block py-2 no-underline hover:text-accent-primary transition-colors mobile-nav-link" aria-label="Navigate to library and book reviews"> Library </a> </li><li> <a href="/en/archive" class="block py-2 no-underline hover:text-accent-primary transition-colors mobile-nav-link" aria-label="Navigate to curated archives"> Archive </a> </li><li> <a href="/en/about" class="block py-2 no-underline hover:text-accent-primary transition-colors mobile-nav-link" aria-label="Navigate to about page"> About </a> </li> </ul> </div> </nav> </div> <script type="module">function m(){const i=document.getElementById("main-nav"),e=document.getElementById("mobile-menu-button"),t=document.getElementById("mobile-menu"),o=document.getElementById("menu-icon"),s=document.getElementById("close-icon"),u=document.querySelectorAll(".mobile-nav-link");if(!i||!e||!t||!o||!s)return;let n=!1;e.addEventListener("click",()=>{n=!n,c()}),u.forEach(a=>{a.addEventListener("click",()=>{n=!1,c()})});function c(){n?(t.classList.remove("max-h-0","opacity-0"),t.classList.add("max-h-64","opacity-100"),o.classList.add("hidden"),s.classList.remove("hidden"),e.setAttribute("aria-expanded","true"),e.setAttribute("aria-label","Close menu")):(t.classList.add("max-h-0","opacity-0"),t.classList.remove("max-h-64","opacity-100"),o.classList.remove("hidden"),s.classList.add("hidden"),e.setAttribute("aria-expanded","false"),e.setAttribute("aria-label","Open menu"))}function l(){const a=window.scrollY,v=document.documentElement.scrollHeight,g=window.innerHeight,r=v-g,d=r>0?a/r*100:0;i.style.background=`linear-gradient(to right, var(--color-bg-nav-progress) 0%, var(--color-bg-nav-progress) ${d}%, var(--color-bg-nav) ${d}%, var(--color-bg-nav) 100%)`}window.addEventListener("scroll",l,{passive:!0}),l()}m();document.addEventListener("astro:after-swap",m);</script> <div class="pt-16 pb-8 text-center"> <h1 class="text-4xl md:text-5xl font-extrabold text-primary leading-tight tracking-tight"> SQL: SELECT </h1> <p class="mt-3 text-lg md:text-xl font-medium text-secondary max-w-2xl mx-auto"> Or maybe a cheatsheet for SELECT command </p> </div> </header> <main id="main-content" class="box-border min-w-0 m-0 leading-relaxed tracking-normal">   <article class="mt-8"> <!-- Article content --> <div class="post-body"> <h2 id="introduction">Introduction<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#introduction"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>The <code>SELECT</code> command is one of the most fundamental and commonly used commands in SQL.
It is primarily used to retrieve data from one or more database tables.</p>
<h3 id="sample-data-dvd-rental">Sample data: DVD Rental<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#sample-data-dvd-rental"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>The website <a href="https://www.postgresqltutorial.com/" rel="noreferrer" target="_blank">PostgresTutorial</a> has prepared
a sample database for learning purposes. You can use this
<a href="https://www.postgresqltutorial.com/postgresql-sample-database/" rel="noreferrer" target="_blank">Link</a> to download
the .zip file of this sample database. In addition,
to load this database into <code>PostgreSQL</code>, you can use the
<a href="https://www.postgresqltutorial.com/load-postgresql-sample-database/" rel="noreferrer" target="_blank">instruction</a>
provided by its website.</p>
<p>The following image displays the ER-Diagram of this sample database.
<img src="/_astro/dvd-rental-sample-database-diagram.Bwp1BsrT_Z2TgK.webp" alt="DVD Rental ER-Diagram" loading="lazy" decoding="async" fetchpriority="auto" width="730" height="920"></p>
<h4 id="import-with-pgadmin">Import with pgAdmin<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#import-with-pgadmin"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h4>
<p>The mentioned dataset can be used in <code>PostgreSQL</code>. To use this dataset, first, you
can set up an environment, as described in  the post about
<a href="/en/sql-postgresql-pgadmin-compose">PostgreSQL and pgAdmin with docker-compose</a>.</p>
<p>Following the steps shown in the figure below, a <em>.tar</em> file can be restored:</p>
<p><img src="/_astro/pgadmin-4-restore-dvdrental.XBx_z11y_2mGA9w.webp" alt="pgAdmin-restore db" loading="lazy" decoding="async" fetchpriority="auto" width="1366" height="528"></p>
<p>if you follow the steps correctly, a prompt as shown in the following figure will be displayed:</p>
<p><img src="/_astro/pgadmin-5-restore-successfuly-dvdrental.ACl0jVjw_Z1bzFlM.webp" alt="pgAdmin-restored successfuly" loading="lazy" decoding="async" fetchpriority="auto" width="555" height="255"></p>
<h2 id="working-with-various-data-structures">Working with various data structures<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#working-with-various-data-structures"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>Some commonly used data types in SQL:</p>
<ol>
<li>
<p><strong>Numeric Data Types</strong>:</p>
<ul>
<li><code>INT</code> or <code>INTEGER</code>: Represents integer values.</li>
<li><code>FLOAT</code> or <code>REAL</code>: Represents floating-point numbers.</li>
<li><code>DECIMAL(p, s)</code> or <code>NUMERIC(p, s)</code>: Represents fixed-point numbers with a specified precision (<code>p</code>) and scale (<code>s</code>).</li>
<li><code>DOUBLE PRECISION</code>: Represents double-precision floating-point numbers.</li>
</ul>
</li>
<li>
<p><strong>Character String Data Types</strong>:</p>
<ul>
<li><code>CHAR(n)</code>: Represents a fixed-length string of length <code>n</code>.</li>
<li><code>VARCHAR(n)</code>: Represents a variable-length string with a maximum length of <code>n</code>.</li>
<li><code>TEXT</code>: Represents variable-length character data of any length.</li>
</ul>
</li>
<li>
<p><strong>Boolean Data Type</strong>:</p>
<ul>
<li><code>BOOLEAN</code> or <code>BOOL</code>: Represents boolean values (<code>TRUE</code> or <code>FALSE</code>).</li>
</ul>
</li>
<li>
<p><strong>Date and Time Data Types</strong>:</p>
<ul>
<li><code>DATE</code>: Represents a date value.</li>
<li><code>TIME</code>: Represents a time value.</li>
<li><code>TIMESTAMP</code>: Represents a date and time value.</li>
<li><code>INTERVAL</code>: Represents a duration or time interval.</li>
</ul>
</li>
<li>
<p><strong>Binary Data Types</strong>:</p>
<ul>
<li><code>BINARY(n)</code>: Represents a fixed-length binary string of length <code>n</code>.</li>
<li><code>VARBINARY(n)</code>: Represents a variable-length binary string with a maximum length of <code>n</code>.</li>
<li><code>BLOB</code>: Represents binary data of variable length.</li>
</ul>
</li>
<li>
<p><strong>Other Data Types</strong>:</p>
<ul>
<li><code>ENUM</code>: Represents a set of predefined values.</li>
<li><code>UUID</code>: Represents a universally unique identifier.</li>
<li><code>JSON</code>: Represents JSON (JavaScript Object Notation) data.</li>
<li><code>XML</code>: Represents XML data.</li>
<li><code>ARRAY</code>: Represents an array or list of values.</li>
</ul>
</li>
</ol>
<h3 id="date-and-time-data-types">Date and Time Data Types<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#date-and-time-data-types"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>To obtain a list of days from a specific date to the current date, we can use the following query:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    CURRENT_DATE </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> today,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> date_time,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    AGE(d) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> age_value, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D">-- calculate age</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    d::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> date_value,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    TO_CHAR(d.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;YYYY/MM/DD&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> formatted,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    EXTRACT(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">MONTH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> d.</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> date_month</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> GENERATE_SERIES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &#39;2021-07-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &#39;2021-07-10&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    INTERVAL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;1 day&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">LIMIT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<h2 id="basic-syntax">Basic Syntax<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#basic-syntax"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>The basic syntax of the SELECT command is as follows:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> column1, column2, ...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> table_name;</span></span></code></pre>
<h3 id="alias">Alias<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#alias"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>Defining an <em>alias</em> for a table and using it. here <code>a</code> is an alias for table <code>actor</code>,
and as you can see we have used this alias in the SELECT statement for selecting
columns <code>first_name</code> (—&gt;a.first_name) and <code>last_name</code> (—&gt;a.last_name) of the table <code>actor</code>.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">last_name</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> actor a</span></span></code></pre>
<h3 id="order-by">ORDER BY<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#order-by"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>To sort data based on the values in one or more columns, use the <code>ORDER BY</code> statement.
You can either name a column or the number of the column in the <code>SELECT</code> statement which starts from 1.
After specifying the “number of the column” in the <code>ORDER BY</code> statement, you should state whether you want to sort the data in Ascending (ASC) or Descending (DESC) order.
If you don’t mention the sorting order, the default which is <code>ASC</code> will be applied.
In the following example, firstly rows will be sorted based on descending order of the second column in the SELECT statement (which is <em>amount</em>),
then they will be sorted based on the ascendingly order of the first column in the <code>SELECT</code> statement (which is <em>payment_date</em>).
Of course, if you use the name of the columns instead of their number, the whole query will become more readable.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_date,amount</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> DESC</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> ASC</span></span></code></pre>
<h3 id="where">WHERE<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#where"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>Suppose we want to put a condition on the month of a date field like <code>payment_date</code>, then we can do it as follows:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_date,amount</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">MONTH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span></code></pre>
<p>Suppose you have a question like “Find the number of payments during the second month of the year.”,
The following query can be used to answer this question. Here, <code>COUNT(*)</code> counts the number of rows with specified conditions.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">MONTH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">IN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
<h3 id="group-by">GROUP BY<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#group-by"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>Suppose you have a question like “Find an array of days in which each customer has at least one payment”,
The following query can be used to answer this question. Here, the <em>ARRAY_AGG</em> function is used to aggregate multiple rows into an array.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id,ARRAY_AGG(payment_date::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id</span></span></code></pre>
<h3 id="having">HAVING<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#having"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>Suppose you want to answer a question like “What is the total income of days which has more than one payment in the third month”.
The following query can be used to answer this question. Please note that to apply conditions on aggregated fields/functions like COUNT, SUM, MIN, MAX, etc., we have to use <code>HAVING</code> statement;
WHERE statement can only apply conditions on non-aggregate fields/functions. Also note that <code>::date</code> is used to cast <em>payment_date</em> to the <code>DATE</code> data type.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_date::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">SUM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(amount)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">MONTH</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_date) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">HAVING</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<h2 id="join">JOIN<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#join"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>Suppose you have a question like “Retrieve name and full address of all employees.”, the following query can be used to answer this question.
Here, tables <em>address</em> and <em>staff</em> are joined based on the condition <code>staff.address_id = address.address_id</code>. Therefore, only rows that fulfill this last condition will appear in the result.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> address</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> staff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> staff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span></span></code></pre>
<p>Suppose you have a question like “How many addresses do not belong to employees?”, the following query can be used to answer this question.
Another way to answer this question is to SUBTRACT the number of rows in tables <em>address</em> from the number of rows in table <em>staff</em>.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> address</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> staff </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> staff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> address</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">address_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> staff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NULL</span></span></code></pre>
<p>Suppose you have a question like “Find number of days in the second month of the year 2007 during which no payments were made.”, the following query can be used to answer this question.
The generate_series() function generates a series of values based on the specified parameters. Here, generate_series() is used to create a series of dates within the range of ‘2007-02-01’ to ‘2007-03-01’.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> GENERATE_SERIES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;2007-02-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;2007-03-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, INTERVAL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;1 day&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> payment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">payment_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> d::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NULL</span></span></code></pre>
<p>Suppose you have a question like “Find the number of days in the second month of the year 2007 during which at least one payment were made.”, the following query can be used to answer this question.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> count</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    DISTINCT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> EXTRACT(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        DAY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> from</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> payment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">payment_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> GENERATE_SERIES</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">    &#39;2007-02-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;2007-03-01&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, INTERVAL </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF">&#39;1 day&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    ) d</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> payment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">payment_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> d::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> payment_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">IS NOT NULL</span></span></code></pre>
<p>Be cautious when using <code>WHERE</code> alongside <code>LEFT JOIN</code>, as it will be applied to the final results.
Sometimes we need to apply the condition during the execution of the <code>JOIN</code> statement. In these kinds of situations, it is better to bring the condition into the <code>ON</code> using the <code>AND</code> operator.</p>
<h2 id="nested-queries">Nested Queries<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#nested-queries"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>Suppose you have a question like “Find the stores from which each customer has made a purchase.”.
On one hand, we can find employees who have rented films in the <em>rental</em> table. On the other hand, using  <em>staff</em> table, we can find stores where employees work in them.
Therefore, the following query can be used to answer the above-mentioned question.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT DISTINCT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> staff s</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<p>Suppose you have a question like “How many stores each customer has purchased from?”, the following query can be used to answer this question.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> customer_store</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT DISTINCT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> staff s</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)customer_store</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<h2 id="common-table-expression-cte">Common table expression (CTE)<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#common-table-expression-cte"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>A cleaner approach to answering the question “How many stores each customer has purchased from?” is to use <code>sql&gt;WITH AS</code> in the way we have used it in the following query:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WITH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_store </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT DISTINCT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">store_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        LEFT JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> staff s</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">staff_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_store</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<p>It is worth mentioning that CTEs won’t be saved and they are solely used to simplify the main query.</p>
<p>In some implementations of RDBMSs, only one WITH statement can be used in each query.
Using that implementation, if several CTEs are needed for a query, you should define them sequentially
as it is shown in the following example:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WITH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> cte_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">), cte_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> ...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span></code></pre>
<h2 id="correlating-several-queries">Correlating several queries<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#correlating-several-queries"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>Suppose you have a question like “Find the ID and date of the first order of each customer.”.
Since GROUP BY is executed on <em>rental_date</em> in the following query, it will display the “first order in each day” instead of displaying “ID and date of the first order of each customer”.
Therefore, this query CANNOT be used to answer the question.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<p>But we can answer the “Find ID and date of the first order of each customer.” question using the following query:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">    min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    )::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span></code></pre>
<p>Another way to answer the “Find ID and date of the first order of each customer.” question is to use the following query:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_rental_id,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span></span></code></pre>
<p>Yet another way to answer the “Find ID and date of the first order of each customer.” question is to use the following query:</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_rental_id,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rental_id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)r2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span></span></code></pre>
<p>To observe the difference in the results of the three above-mentioned solutions,
the following method can be used (the result of the following command is zero, indicating the consistency of the results):</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WITH</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_rental_id,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> min</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        )::</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    GROUP BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> 1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">s2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_rental_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> as</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">s3 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_rental_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> first_order_date</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental r</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">            MIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(rental_id) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rental</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        GROUP BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> customer_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">    )r2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rental_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ORDER BY</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> r</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">customer_id</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FULL OUTER JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s2</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_rental_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FULL OUTER JOIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> s3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ON</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_rental_id</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_rental_id</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">WHERE</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_order_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NULL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    OR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_order_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NULL</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    OR</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> s3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">first_order_date</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> IS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> NULL</span></span></code></pre>
<h2 id="case">CASE<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#case"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h2>
<p>Suppose you have a question like “Replacement cost for each film is more or less than the average?”, the following query can be used to answer this question.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> film_id, title, replacement_cost,</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">CASE</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    WHEN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> replacement_cost </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        SELECT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> AVG</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(replacement_cost)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">        FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> film</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        )</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    THEN</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> &#39;gt_avg&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    ELSE</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF"> &#39;le_avg&#39;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    END</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> replacement_cost_status</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> film</span></span></code></pre>
<p>Probably the most common way to answer this question is to use the <code>UNION</code> statement if you don’t want to use the <code>CASE</code> statement.</p>
<h3 id="window-function">Window Function<a class="autolink-hdrs" aria-hidden="true" tabindex="-1" href="#window-function"><span><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg></span></a></h3>
<p>Suppose you have a question like “How many films exist in each rating category?”, the following query can be used to answer this question.</p>
<pre class="astro-code astro-code-themes github-light github-dark" style="--shiki-light:#24292e;--shiki-dark:#e1e4e8;--shiki-light-bg:#fff;--shiki-dark-bg:#24292e;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="sql"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">SELECT DISTINCT</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">rating</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">f</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">film_count</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    SELECT</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">        rating,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF">        COUNT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">OVER</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> (</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">            PARTITION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583"> BY</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> rating</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">            ) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">AS</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> film_count</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583">    FROM</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8"> film</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8">) f</span></span></code></pre>
<p>Notice the usage of sql&gt; window_function OVER(PARTITION BY field) in the above query.
When we need to aggregate data, we can use <code>GROUP BY</code>,
and when we want to analyze data in a categorized manner, we can use <code>PARTITION BY</code>.</p> </div> <!-- Article metadata at the end --> <div class="mt-8 text-sm text-secondary"> <div class="mt-32"> <p class="mt-8 text-center text-secondary">Tags of this Post:</p> <ul class="flex flex-wrap items-baseline mt-2 ms-1 @md:mt-0 justify-center"> <li class="z-10 inline-block px-2 m-1 text-sm border-2 rounded-full shadow-xs bg-nav text-primary"> <a href="/en/tag/programming" class="no-underline hover:text-accent-primary transition-colors">
#programming </a> </li><li class="z-10 inline-block px-2 m-1 text-sm border-2 rounded-full shadow-xs bg-nav text-primary"> <a href="/en/tag/data" class="no-underline hover:text-accent-primary transition-colors">
#data </a> </li><li class="z-10 inline-block px-2 m-1 text-sm border-2 rounded-full shadow-xs bg-nav text-primary"> <a href="/en/tag/sql" class="no-underline hover:text-accent-primary transition-colors">
#sql </a> </li> </ul> </div> </div> </article>   </main> <footer class="box-border flex flex-row justify-between pt-4 mt-8 mb-4 border-t-2 border-primary"> <p class="text-center align-middle text-secondary">
Copyright &copy; 2026 by <a href="/en/about" class="font-medium no-underline hover:text-accent-primary transition-colors" aria-label="Navigate to about page">Saeed Asaiyan</a>.
</p> <ul class="flex justify-center" aria-label="Social media and feed links"> <li class="mx-4"> <a href="/en/rss.xml" target="_blank" rel="noreferrer" aria-label="Subscribe to RSS feed (opens in new tab)"> <svg class="w-8 h-8 fill-current text-secondary" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"> <title>RSS Feed</title> <path d="M6.18 15.64a2.18 2.18 0 1 1 0 4.36 2.18 2.18 0 0 1 0-4.36m12.18 4.36A14.38 14.38 0 0 0 4 5.64v3.09a11.28 11.28 0 0 1 11.27 11.27h3.09M13.09 20a9.27 9.27 0 0 0-9.09-9.09v3.09A6.18 6.18 0 0 1 10 20h3.09"></path> </svg> </a> </li> <li class="mx-4"> <a href="https://github.com/upr8" target="_blank" rel="noreferrer" aria-label="Visit GitHub profile (opens in new tab)"> <svg class="w-8 h-8 fill-current text-secondary" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false"> <title>GitHub</title> <path d="M12 .3a12 12 0 00-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.07 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 016 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 011.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0012 .3"></path> </svg> </a> </li> </ul> </footer> </div> </div> </body></html> <script type="module">const a='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1z"/><path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0z"/></svg>',c='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16"><path d="M12.736 3.97a.733.733 0 0 1 1.047 0c.286.289.29.756.01 1.05L7.88 12.01a.733.733 0 0 1-1.065.02L3.217 8.384a.757.757 0 0 1 0-1.06.733.733 0 0 1 1.047 0l3.052 3.093 5.4-6.425z"/></svg>';document.querySelectorAll(".post-body pre").forEach(t=>{const e=document.createElement("button");e.className="copy-button",e.setAttribute("aria-label","Copy code"),e.insertAdjacentHTML("beforeend",a),e.addEventListener("click",async()=>{const o=t.querySelector("code")?.textContent||"";await navigator.clipboard.writeText(o),e.classList.add("copied"),e.replaceChildren(),e.insertAdjacentHTML("beforeend",c),setTimeout(()=>{e.classList.remove("copied"),e.replaceChildren(),e.insertAdjacentHTML("beforeend",a)},2e3)}),t.appendChild(e)});</script>